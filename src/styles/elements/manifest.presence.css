/* Manifest Presence - Visual Indicators */

/* CSS Variables - move to manifest.theme.css after testing completes */
:root {
    /* Focus indicator */
    --presence-focus-outline-width: 2px;
    --presence-focus-outline-style: dashed;
    --presence-focus-outline-offset: 2px;
    --presence-focus-opacity: 0.6;
    --presence-focus-color: #3b82f6;

    /* Text caret indicator */
    --presence-caret-width: 2px;
    --presence-caret-height: 1.2em;
    --presence-caret-color: #3b82f6;
    --presence-caret-z-index: 1000;
    --presence-caret-blink-duration: 1s;
    --presence-caret-opacity-high: 1;
    --presence-caret-opacity-low: 0.3;

    /* Text selection highlight */
    --presence-selection-color: #3b82f6;
    --presence-selection-opacity: 0.2;
    --presence-selection-z-index: 999;

    /* Cursor indicator (if rendered) */
    --presence-cursor-size: 8px;
    --presence-cursor-border-width: 2px;
    --presence-cursor-z-index: 1001;

    /* Timing and threshold configuration (read by JavaScript) */
    --presence-throttle: 300ms;
    --presence-cleanup-interval: 30000ms;
    --presence-min-change-threshold: 5px;
    --presence-idle-threshold: 5000ms;
}

@layer elements {

    /* Focus indicator - applied to elements focused by other users */
    :where(.presence-focused) {
        outline: var(--presence-focus-outline-width) var(--presence-focus-outline-style) var(--presence-focus-color);
        outline-offset: var(--presence-focus-outline-offset);
        opacity: var(--presence-focus-opacity);
    }

    /* Dynamic focus color via data attribute */
    :where(.presence-focused[data-presence-focus-color]) {
        --presence-focus-color: attr(data-presence-focus-color);
        outline-color: var(--presence-focus-color);
    }

    /* Caret indicator for other users' text cursors */
    :where(.presence-caret) {
        position: absolute;
        width: var(--presence-caret-width);
        height: var(--presence-caret-height);
        background-color: var(--presence-caret-color);
        pointer-events: none;
        z-index: var(--presence-caret-z-index);
        animation: presence-caret-blink var(--presence-caret-blink-duration) infinite;
    }

    /* Dynamic caret color via data attribute */
    :where(.presence-caret[data-presence-caret-color]),
    [data-presence-caret-color] .presence-caret {
        --presence-caret-color: attr(data-presence-caret-color);
    }

    /* Caret blink animation */
    @keyframes presence-caret-blink {

        0%,
        50% {
            opacity: var(--presence-caret-opacity-high);
        }

        51%,
        100% {
            opacity: var(--presence-caret-opacity-low);
        }
    }

    /* Selection highlight for other users' text selections */
    :where(.presence-selection) {
        position: absolute;
        background-color: var(--presence-selection-color);
        opacity: var(--presence-selection-opacity);
        pointer-events: none;
        z-index: var(--presence-selection-z-index);
    }

    /* Dynamic selection color - plugin sets CSS variable via setProperty */
    :where(.presence-selection) {
        background-color: var(--presence-selection-color);
    }

    /* Cursor indicator (for mouse/touch cursors) */
    :where(.presence-cursor) {
        position: absolute;
        width: var(--presence-cursor-size);
        height: var(--presence-cursor-size);
        border: var(--presence-cursor-border-width) solid var(--presence-cursor-color, var(--presence-focus-color));
        border-radius: 50%;
        background-color: var(--presence-cursor-color, var(--presence-focus-color));
        pointer-events: none;
        z-index: var(--presence-cursor-z-index);
        transform: translate(-50%, -50%);
    }

    /* Cursor label (user name) */
    :where(.presence-cursor-label) {
        position: absolute;
        top: calc(var(--presence-cursor-size) + 4px);
        left: 50%;
        transform: translateX(-50%);
        background-color: var(--presence-cursor-color, var(--presence-focus-color));
        color: white;
        padding: 2px 6px;
        border-radius: 4px;
        font-size: 12px;
        white-space: nowrap;
        pointer-events: none;
        z-index: calc(var(--presence-cursor-z-index) + 1);
    }

    /* Element that contains presence indicators */
    :where([data-presence-caret-user], [data-presence-selection-user], [data-presence-focus-user]) {
        position: relative;
    }
}